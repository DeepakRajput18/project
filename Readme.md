# Tool Wear Prediction System

This repository contains a Python-based tool wear prediction system that uses machine learning to predict the amount of wear on a cutting tool based on sensor data.

## Overview

The system consists of the following main components:

*   **`tool_wear_prediction.py`:** This script loads sensor data and tool wear measurements, trains a machine learning model (Random Forest Regressor), makes predictions on new data, evaluates the model's performance, and saves the predictions to a CSV file.
*   **`visualizer.py`:** This script loads the predictions from the CSV file and generates visualizations to help analyze the model's performance.  It can create scatter plots of actual vs. predicted values, residual plots, and histograms of the residuals.
*   **`tool_wear_data.csv`:** This file contains sample sensor data and corresponding tool wear values.  It's used for training and testing the model.
*   **`tool_wear_predictions.csv`:** This file is generated by `tool_wear_prediction.py` and contains the model's predictions.
*   **`README.md`:** This file provides an overview of the system and instructions for setting it up and running it.
*   **`scheduler.py`:** This script simulates a real-world scenario where the tool wear prediction process is run periodically (e.g., every hour).

## Requirements

*   Python 3.7 or higher
*   The following Python libraries:
    *   pandas
    *   scikit-learn
    *   matplotlib
    *   seaborn
    *   streamlit (optional, for the Streamlit visualizer)
    *   schedule

## Installation

1.  **Clone the repository:**

    ```bash
    git clone <repository_url>
    cd tool-wear-prediction
    ```

2.  **Install the required Python libraries:**

    ```bash
    pip install pandas scikit-learn matplotlib seaborn schedule
    pip install streamlit  # Optional, for the Streamlit visualizer
    ```

## Usage

### 1. Data Preparation

*   The system uses the `tool_wear_data.csv` file as the training dataset.  You can replace this file with your own dataset, but make sure the data is in the correct format (CSV with columns for sensor readings and tool wear).  The column names should match the names used in the `tool_wear_prediction.py` script.

### 2. Running the Prediction Script

*   To train the model and generate predictions, run the `tool_wear_prediction.py` script:

    ```bash
    python tool_wear_prediction.py
    ```

    This will:

    *   Load the data from `tool_wear_data.csv`.
    *   Preprocess the data (scaling).
    *   Train a Random Forest Regressor model.
    *   Make predictions on the test data.
    *   Evaluate the model's performance (Mean Squared Error and R-squared).
    *   Save the predictions to `tool_wear_predictions.csv`.

### 3. Visualizing the Results

*   To visualize the predictions, run the `visualizer.py` script.  You have two options:

    *   **Command-Line Version:**

        ```bash
        python visualizer.py
        ```

        This will generate the plots in separate windows using Matplotlib.

    *   **Streamlit Version:**

        ```bash
        streamlit run visualizer.py -- --streamlit
        ```

        This will open a Streamlit app in your web browser that displays the visualizations.  The `-- --streamlit` part is important.

### 4. Scheduling the Prediction Process

*   To simulate a real-world scenario where the prediction process is run periodically, use the `scheduler.py` script:

    ```bash
    python scheduler.py
    ```

    This will run the `tool_wear_prediction.py` script every hour (by default).  You can adjust the scheduling interval by modifying the `schedule.every().hour.do(main)` line in the `scheduler.py` script.

## Customization

*   **Data File:**  Change the `DATA_FILE` variable in `tool_wear_prediction.py` to point to your own data file.
*   **Model:**  Modify the `train_model()` function in `tool_wear_prediction.py` to use a different machine learning model.
*   **Hyperparameters:**  Tune the hyperparameters of the model to optimize its performance.
*   **Features:**  Engineer new features from the sensor data to improve the model's accuracy.
*   **Visualizations:**  Add more visualizations to the `visualizer.py` script to gain further insights into the model's performance.
*   **Scheduling Interval:**  Adjust the scheduling interval in `scheduler.py` to match your desired frequency.
*   **Logging Level:** Change the logging level in `tool_wear_prediction.py` to control the amount of information that is logged.

## Troubleshooting

*   **File Not Found Errors:**  Make sure that the data files (`tool_wear_data.csv` and `tool_wear_predictions.csv`) are in the correct locations and that the file paths in the scripts are correct.
*   **Import Errors:**  Make sure that all of the required Python libraries are installed.
*   **Plotting Issues:**  If you are having trouble with the plots, make sure that you have a working Matplotlib installation.
*   **Streamlit Issues:**  If you are having trouble with the Streamlit app, make sure that you have Streamlit installed correctly and that you are running the app using the `streamlit run` command.

## License

This project is licensed under the MIT License - see the `LICENSE` file for details.

## Contributing

Contributions are welcome!  Please submit a pull request with your changes.